# System Architecture Diagram

## Complete System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          FRONTEND (Next.js)                              â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Sidebar    â”‚    â”‚   ChatPane   â”‚    â”‚   Composer   â”‚             â”‚
â”‚  â”‚              â”‚    â”‚              â”‚    â”‚              â”‚             â”‚
â”‚  â”‚ - Templates  â”‚â”€â”€â”€â–¶â”‚ - Messages   â”‚â—€â”€â”€â”€â”‚ - Input      â”‚             â”‚
â”‚  â”‚ - Folders    â”‚    â”‚ - Progress   â”‚    â”‚ - Actions    â”‚             â”‚
â”‚  â”‚ - Conversations   â”‚ - Reports    â”‚    â”‚              â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â”‚                     â”‚                   â”‚                     â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                               â”‚                                         â”‚
â”‚                        lib/api-client.ts                                â”‚
â”‚                               â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                          HTTP/REST API
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        BACKEND (FastAPI)                                 â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      main.py (FastAPI App)                     â”‚    â”‚
â”‚  â”‚  - CORS middleware                                             â”‚    â”‚
â”‚  â”‚  - Error handlers                                              â”‚    â”‚
â”‚  â”‚  - Health checks                                               â”‚    â”‚
â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚      â”‚                                                      â”‚           â”‚
â”‚  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  routers/research_router.pyâ”‚                 â”‚   config.py       â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                 â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚  â”‚
â”‚  â”‚  POST   /start             â”‚                 â”‚   - Environment   â”‚  â”‚
â”‚  â”‚  GET    /{id}/status       â”‚                 â”‚   - CORS origins  â”‚  â”‚
â”‚  â”‚  GET    /{id}/result       â”‚                 â”‚   - Timeouts      â”‚  â”‚
â”‚  â”‚  GET    /questions         â”‚                 â”‚   - Capacity      â”‚  â”‚
â”‚  â”‚  GET    /sessions          â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚  DELETE /{id}              â”‚                                         â”‚
â”‚  â”‚  GET    /statistics        â”‚                                         â”‚
â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚      â”‚                                                                   â”‚
â”‚      â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              services/session_manager.py                         â”‚  â”‚
â”‚  â”‚              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚  â”‚
â”‚  â”‚  - In-memory session storage                                    â”‚  â”‚
â”‚  â”‚  - CRUD operations (create, get, update, delete)                â”‚  â”‚
â”‚  â”‚  - Automatic cleanup (every 5 minutes)                          â”‚  â”‚
â”‚  â”‚  - Capacity management (max 100 sessions)                       â”‚  â”‚
â”‚  â”‚  - Session timeout (60 minutes)                                 â”‚  â”‚
â”‚  â”‚  - Statistics tracking                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚      â”‚                                                                   â”‚
â”‚      â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            services/research_service.py                          â”‚  â”‚
â”‚  â”‚            â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚  â”‚
â”‚  â”‚  ResearchService.conduct_research()                             â”‚  â”‚
â”‚  â”‚    â”‚                                                             â”‚  â”‚
â”‚  â”‚    â”œâ”€â–¶ Phase 1: Data Collection (Parallel)                      â”‚  â”‚
â”‚  â”‚    â”‚   â”œâ”€ Twitter Intelligence Agent                            â”‚  â”‚
â”‚  â”‚    â”‚   â”œâ”€ TikTok Intelligence Agent                             â”‚  â”‚
â”‚  â”‚    â”‚   â”œâ”€ Reddit Intelligence Agent                             â”‚  â”‚
â”‚  â”‚    â”‚   â”œâ”€ Google Trends Agent                                   â”‚  â”‚
â”‚  â”‚    â”‚   â””â”€ Web Search Agent                                      â”‚  â”‚
â”‚  â”‚    â”‚                                                             â”‚  â”‚
â”‚  â”‚    â”œâ”€â–¶ Phase 2: Analysis (Sequential)                           â”‚  â”‚
â”‚  â”‚    â”‚   â””â”€ Analysis Agent (Azure OpenAI)                         â”‚  â”‚
â”‚  â”‚    â”‚                                                             â”‚  â”‚
â”‚  â”‚    â””â”€â–¶ Phase 3: Report Generation                               â”‚  â”‚
â”‚  â”‚        â””â”€ Report Generator Agent (Azure OpenAI)                 â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚      â”‚                                                                   â”‚
â”‚      â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              API Connectors (Mock + Real)                        â”‚  â”‚
â”‚  â”‚              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚  â”‚
â”‚  â”‚  â”‚  Mock APIs      â”‚  â”‚  Real APIs      â”‚                       â”‚  â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚                       â”‚  â”‚
â”‚  â”‚  â”‚  - Twitter      â”‚  â”‚  - Twitter      â”‚  (requires API keys)  â”‚  â”‚
â”‚  â”‚  â”‚  - TikTok       â”‚  â”‚  - TikTok       â”‚                       â”‚  â”‚
â”‚  â”‚  â”‚  - Reddit       â”‚  â”‚  - Reddit       â”‚                       â”‚  â”‚
â”‚  â”‚  â”‚  - Trends       â”‚  â”‚  - Trends       â”‚                       â”‚  â”‚
â”‚  â”‚  â”‚  - Web Search   â”‚  â”‚  - Bing Search  â”‚                       â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â”‚
â”‚  â”‚          â”‚                      â”‚                                â”‚  â”‚
â”‚  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚  â”‚
â”‚  â”‚                     â”‚                                            â”‚  â”‚
â”‚  â”‚            Automatic Fallback                                    â”‚  â”‚
â”‚  â”‚        (Uses Mock if Real not configured)                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Request Flow Diagram

### Starting a Research Session

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client â”‚                    â”‚  API   â”‚                    â”‚  Session   â”‚
â”‚        â”‚                    â”‚ Router â”‚                    â”‚  Manager   â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
    â”‚                             â”‚                               â”‚
    â”‚ POST /start                 â”‚                               â”‚
    â”‚ {question_id: "..."}        â”‚                               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                               â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚ Validate request              â”‚
    â”‚                             â”‚ Check capacity                â”‚
    â”‚                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                             â”‚ Capacity OK                   â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚ Create session                â”‚
    â”‚                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                             â”‚ {session_id: "uuid"}          â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚ Start async task              â”‚
    â”‚                             â”‚ (doesn't block)               â”‚
    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
    â”‚ 200 OK                      â”‚                               â”‚
    â”‚ {session_id: "uuid"}        â”‚                               â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚                               â”‚
    â”‚                        â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                         â”‚
    â”‚                        â”‚ Research â”‚                         â”‚
    â”‚                        â”‚   Task   â”‚                         â”‚
    â”‚                        â”‚ (Async)  â”‚                         â”‚
    â”‚                        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                         â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚ Progress Callback             â”‚
    â”‚                             â”‚ update_session()              â”‚
    â”‚                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚                               â”‚
```

### Polling for Progress

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client â”‚                    â”‚  API   â”‚                    â”‚  Session   â”‚
â”‚        â”‚                    â”‚ Router â”‚                    â”‚  Manager   â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
    â”‚                             â”‚                               â”‚
    â”‚ GET /{id}/status            â”‚                               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                               â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚ Get session                   â”‚
    â”‚                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                             â”‚ {phase, progress, updates}    â”‚
    â”‚                             â”‚                               â”‚
    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
    â”‚ 200 OK                      â”‚                               â”‚
    â”‚ {phase: "data_collection",  â”‚                               â”‚
    â”‚  progress_percentage: 40,   â”‚                               â”‚
    â”‚  progress_updates: [...]}   â”‚                               â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚                               â”‚
    â”‚ (wait 3 seconds)            â”‚                               â”‚
    â”‚                             â”‚                               â”‚
    â”‚ GET /{id}/status            â”‚                               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                               â”‚
    â”‚                             â”‚                               â”‚
    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
    â”‚ 200 OK                      â”‚                               â”‚
    â”‚ {phase: "completed",        â”‚                               â”‚
    â”‚  progress_percentage: 100}  â”‚                               â”‚
    â”‚                             â”‚                               â”‚
```

### Retrieving Results

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client â”‚                    â”‚  API   â”‚                    â”‚  Session   â”‚
â”‚        â”‚                    â”‚ Router â”‚                    â”‚  Manager   â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
    â”‚                             â”‚                               â”‚
    â”‚ GET /{id}/result            â”‚                               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                               â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚ Get session                   â”‚
    â”‚                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                             â”‚ {result: ResearchResult}      â”‚
    â”‚                             â”‚                               â”‚
    â”‚                             â”‚ Validate completed            â”‚
    â”‚                             â”‚                               â”‚
    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
    â”‚ 200 OK                      â”‚                               â”‚
    â”‚ {                           â”‚                               â”‚
    â”‚   executive_summary: "...", â”‚                               â”‚
    â”‚   key_findings: [...],      â”‚                               â”‚
    â”‚   recommendations: [...],   â”‚                               â”‚
    â”‚   report: "..."             â”‚                               â”‚
    â”‚ }                           â”‚                               â”‚
    â”‚                             â”‚                               â”‚
```

---

## Data Flow During Research

```
1. START REQUEST
   Client â”€â”€â–¶ API Router â”€â”€â–¶ Session Manager â”€â”€â–¶ Create Session
                   â”‚
                   â””â”€â”€â–¶ Create Async Task

2. DATA COLLECTION (Parallel)
   Research Task â”€â”€â”¬â”€â”€â–¶ Twitter Agent â”€â”€â”¬â”€â”€â–¶ Mock/Real API
                   â”œâ”€â”€â–¶ TikTok Agent  â”€â”€â”¼â”€â”€â–¶ Mock/Real API
                   â”œâ”€â”€â–¶ Reddit Agent  â”€â”€â”¼â”€â”€â–¶ Mock/Real API
                   â”œâ”€â”€â–¶ Trends Agent  â”€â”€â”¼â”€â”€â–¶ Mock/Real API
                   â””â”€â”€â–¶ Web Agent     â”€â”€â”´â”€â”€â–¶ Mock/Real API
                       â”‚
                       â””â”€â”€â–¶ Progress Callback â”€â”€â–¶ Session Manager

3. ANALYSIS
   Research Task â”€â”€â–¶ Analysis Agent â”€â”€â–¶ Azure OpenAI
                       â”‚
                       â””â”€â”€â–¶ Progress Callback â”€â”€â–¶ Session Manager

4. REPORT GENERATION
   Research Task â”€â”€â–¶ Report Agent â”€â”€â–¶ Azure OpenAI
                       â”‚
                       â””â”€â”€â–¶ Final Result â”€â”€â–¶ Session Manager

5. RETRIEVE RESULT
   Client â”€â”€â–¶ API Router â”€â”€â–¶ Session Manager â”€â”€â–¶ Return Result
```

---

## Session Lifecycle

```
CREATE
  â”‚
  â–¼
PENDING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                     â”‚
  â”‚ start_research()    â”‚ timeout (60 min)
  â”‚                     â”‚
  â–¼                     â”‚
DATA_COLLECTION â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                     â”‚
  â”‚ data collected      â”‚
  â”‚                     â”‚
  â–¼                     â”‚
ANALYSIS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                     â”‚
  â”‚ analysis done       â”‚
  â”‚                     â”‚
  â–¼                     â”‚
REPORT_GENERATION â”€â”€â”€â”€â”€â”€â”¤
  â”‚                     â”‚
  â”‚ report generated    â”‚
  â”‚                     â”‚
  â–¼                     â”‚
COMPLETED â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                     â”‚
  â”‚ 30 min retention    â”‚
  â”‚                     â”‚
  â–¼                     â”‚
DELETED â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                   FAILED
                        â”‚
                        â”‚ 30 min retention
                        â”‚
                        â–¼
                    DELETED
```

---

## Component Dependencies

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    main.py                      â”‚
â”‚  (FastAPI app, CORS, error handlers)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                         â”‚
        â”‚                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  research_router â”‚      â”‚      config.py        â”‚
â”‚   (7 endpoints)  â”‚      â”‚  (settings, env vars) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            session_manager.py                    â”‚
â”‚  (session storage, cleanup, statistics)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            research_service.py                   â”‚
â”‚  (orchestration, agents, callbacks)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         api_connectors_mock.py                   â”‚
â”‚         api_connectors_real.py                   â”‚
â”‚  (data sources with fallback logic)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Frontend Integration (Coming in Step 5)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Next.js Frontend                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  lib/api-client.ts                              â”‚
â”‚  â”œâ”€ startResearch(request)                      â”‚
â”‚  â”œâ”€ getResearchStatus(sessionId)                â”‚
â”‚  â”œâ”€ getResearchResult(sessionId)                â”‚
â”‚  â”œâ”€ getResearchQuestions()                      â”‚
â”‚  â””â”€ listSessions(filters)                       â”‚
â”‚                                                 â”‚
â”‚  components/AIAssistantUI.jsx                   â”‚
â”‚  â”œâ”€ Load questions from API                     â”‚
â”‚  â”œâ”€ Handle research start                       â”‚
â”‚  â”œâ”€ Poll for status (every 3 sec)               â”‚
â”‚  â””â”€ Display results                             â”‚
â”‚                                                 â”‚
â”‚  components/ChatPane.jsx                        â”‚
â”‚  â”œâ”€ Render progress messages                    â”‚
â”‚  â”œâ”€ Show loading states                         â”‚
â”‚  â””â”€ Format report sections                      â”‚
â”‚                                                 â”‚
â”‚  components/Sidebar.jsx                         â”‚
â”‚  â”œâ”€ Display question templates                  â”‚
â”‚  â””â”€ List active conversations                   â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ HTTP/REST
           â”‚
           â–¼
    FastAPI Backend
    (Already Built âœ…)
```

---

## Summary

**Backend (âœ… Complete):**
- FastAPI server running
- 7 REST endpoints working
- Session management operational
- Research service functional
- Progress tracking active
- Mock data collection working

**Frontend (ğŸ“‹ Next Steps):**
- Create API client
- Update chat interface
- Display progress
- Format reports
- End-to-end testing

**Ready to integrate!** ğŸš€
